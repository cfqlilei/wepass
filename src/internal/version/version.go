package version

/**
 * 版本信息管理
 * @author 陈凤庆
 * @date 2025-10-01
 * @description 统一管理应用版本号和更新日志
 */

const (
	// AppName 应用名称
	AppName = "密码管理器"

	// Version 当前版本号
	// 20251019 陈凤庆 修复问题 002-1 和 002-2，版本号从1.0.4更新为1.0.5
	// 20251019 陈凤庆 修复问题 003-1、003-2 和 003-3，版本号从1.0.5更新为1.0.6
	// 20251019 陈凤庆 新增分组页签记忆功能，版本号从1.0.6更新为1.0.7
	// 20251019 陈凤庆 修复问题 004：增强调试日志和数据验证，版本号从1.0.7更新为1.0.8
	Version = "1.0.8"

	// BuildDate 构建日期
	BuildDate = "2025-10-19"

	// Author 作者
	Author = "陈凤庆"
)

// ChangeLog 更新日志
var ChangeLog = []ChangeLogEntry{
	{
		Version: "1.0.8",
		Date:    "2025-10-19",
		Changes: []string{
			"[修复] 问题 004：分组切换后创建账号偶发性保存失败，增强数据流跟踪和验证",
			"[增强] 前端调试日志：createAccount和handleSaveAccount函数增加详细状态跟踪",
			"[增强] 后端调试日志：CreateAccount和validateTypeID函数增加参数验证和错误诊断",
			"[增强] API调试日志：createPasswordItem函数增加完整的数据流跟踪",
			"[优化] 数据恢复机制：当关键字段丢失时自动从当前状态恢复",
			"[优化] 错误处理：提供更详细的错误信息和诊断数据，便于问题排查",
			"[优化] 状态同步：改进分组和标签切换时的状态同步逻辑",
		},
	},
	{
		Version: "1.0.7",
		Date:    "2025-10-19",
		Changes: []string{
			"[新增] 分组页签记忆功能：切换分组时自动选择第一个页签或上次选中的页签",
			"[新增] 页签选择记忆：记录每个分组最后一次选中的页签，下次进入时自动恢复",
			"[新增] localStorage持久化存储：页签记忆数据保存到本地存储，重启应用后仍然有效",
			"[优化] 分组切换逻辑：改进selectGroup函数，支持智能页签选择和记忆功能",
			"[优化] 应用启动流程：启动时自动加载页签记忆数据，提升用户体验",
			"[优化] 状态管理：在Pinia store中增加页签记忆相关的状态和方法",
		},
	},
	{
		Version: "1.0.6",
		Date:    "2025-10-19",
		Changes: []string{
			"[修复] 问题 003-1：切换分组后创建账号保存失败，增加详细调试日志跟踪状态变化",
			"[修复] 问题 003-2：保存密码规则失败 - undefined错误，支持更新现有规则而非只能创建",
			"[修复] 问题 003-3：密码规则名称输入框编辑问题，改用autocomplete组件支持更好的编辑体验",
			"[优化] 创建账号和保存账号过程增加详细日志，便于问题排查和调试",
			"[优化] 分组和标签切换过程增加状态跟踪日志，提高问题定位效率",
			"[优化] 密码规则保存逻辑，支持重复名称时自动更新现有规则",
			"[优化] 密码规则名称输入框交互体验，支持自动完成和正常编辑",
		},
	},
	{
		Version: "1.0.5",
		Date:    "2025-10-19",
		Changes: []string{
			"[修复] 问题 002-1：创建账号保存失败 - 未知错误，切换标签后创建账号时需要先选择标签",
			"[修复] 问题 002-2：标签重命名时序问题，快速输入时偶尔出现'标签名称未改变'的问题",
			"[优化] 创建账号时添加标签选择验证，确保用户先选择标签再创建账号",
			"[优化] 标签重命名时改进字符串比较逻辑，确保正确处理空格",
		},
	},
	{
		Version: "1.0.4",
		Date:    "2025-10-18",
		Changes: []string{
			"[修复] 搜索功能时序问题：快速输入时显示所有数据而非过滤数据",
			"[优化] 搜索框添加防抖机制，避免快速输入时发送过多请求",
			"[优化] 搜索请求添加取消机制，确保只显示最新搜索的结果",
			"[优化] 改进搜索性能，减少不必要的网络请求",
		},
	},
	{
		Version: "1.0.3",
		Date:    "2025-10-18",
		Changes: []string{
			"[新增] 账号右键菜单显示密码功能",
			"[新增] 密码显示对话框，支持密码分段显示",
			"[新增] 密码隐藏/显示切换功能",
			"[新增] 密码复制功能，10秒后自动清理剪贴板",
			"[优化] 移除账号右键菜单中的输入用户名和密码功能",
			"[优化] 调整右键菜单布局，显示密码移至打开地址后面",
		},
	},
	{
		Version: "1.0.2",
		Date:    "2025-10-03",
		Changes: []string{
			"[新增] 更多菜单中选择新密码框功能",
			"[新增] 账号详情中备注信息脱敏显示",
			"[优化] 账号详情中备注编辑框样式和对齐",
			"[优化] 备注框按钮位置和对齐方式",
			"[优化] 取消账号列表分页显示，采用全部显示",
			"[修复] 界面布局和交互体验优化",
		},
	},
	{
		Version: "1.0.1",
		Date:    "2025-10-02",
		Changes: []string{
			"[新增] 统一版本号管理系统",
			"[新增] 跨平台编译脚本和命令",
			"[优化] 版本号在各界面的统一显示",
			"[优化] 构建日期和时间规范",
		},
	},
	{
		Version: "1.0.0",
		Date:    "2025-10-01",
		Changes: []string{
			"[新增] 密码库创建界面优化，自动创建data目录",
			"[新增] 支持简单名称创建密码库，自动添加.db后缀",
			"[新增] 简化模式和完整模式自动切换",
			"[新增] 自动填充功能，支持用户名和密码自动填充",
			"[新增] 跨应用程序窗口焦点管理",
			"[新增] 密码生成器功能",
			"[新增] 分组和标签管理",
			"[新增] 搜索功能，支持模糊搜索",
			"[优化] 界面布局和交互体验",
			"[优化] 数据加密安全性",
			"[修复] 多个已知问题",
		},
	},
}

// ChangeLogEntry 更新日志条目
type ChangeLogEntry struct {
	Version string   // 版本号
	Date    string   // 发布日期
	Changes []string // 更新内容列表
}

// GetVersion 获取版本号
func GetVersion() string {
	return Version
}

// GetAppName 获取应用名称
func GetAppName() string {
	return AppName
}

// GetFullVersion 获取完整版本信息
func GetFullVersion() string {
	return AppName + " v" + Version
}

// GetChangeLog 获取更新日志
func GetChangeLog() []ChangeLogEntry {
	return ChangeLog
}
